<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vorliyo - ஃப்ரீலான்ஸ் தளம்</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <header class="bg-white shadow-md sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <a href="user-index.html" class="text-3xl font-extrabold text-indigo-600 tracking-tight">Vorliyo</a>
            
            <nav class="flex items-center space-x-6">
                <a href="user-post-job.html" id="postJobBtn" class="text-gray-600 hover:text-indigo-600 font-semibold hidden">வேலையை வெளியிட</a>
                <a href="user-dashboard.html" id="dashboardLink" class="text-gray-600 hover:text-indigo-600 font-semibold hidden">டாஷ்போர்டு</a>
                <button onclick="window.location.href='user-login.html'" id="authButton" class="bg-indigo-600 text-white px-4 py-2 rounded-full hover:bg-indigo-700 transition duration-150 shadow-md text-sm">
                    உள்நுழைய / பதிவு செய்ய
                </button>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <section class="text-center mb-12 py-10 bg-white rounded-xl shadow-lg border-t-4 border-indigo-500">
            <h2 class="text-4xl sm:text-5xl font-extrabold text-gray-900 mb-4">
                வேலை தேடுகிறீர்களா? <span class="text-indigo-600">வேலையாட்களைத்</span> தேடுகிறீர்களா?
            </h2>
            <p class="text-xl text-gray-600 mb-6 max-w-3xl mx-auto">
                மிகச் சிறந்த ஃப்ரீலான்ஸ் திறமைகள் மற்றும் வேலைகளை Vorliyo-வில் கண்டறியுங்கள்.
            </p>
            <div class="flex justify-center space-x-4">
                <button onclick="changeView('jobs')" id="jobViewBtn" class="px-6 py-3 border-2 border-indigo-600 text-white bg-indigo-600 rounded-lg font-bold transition duration-150 shadow-lg">வேலைப் பட்டியல்கள்</button>
                <button onclick="changeView('services')" id="serviceViewBtn" class="px-6 py-3 border-2 border-indigo-600 text-indigo-600 bg-white rounded-lg font-bold hover:bg-indigo-50 transition duration-150 shadow-md">சேவைகள் (Gigs)</button>
            </div>
        </section>

        <section class="mb-10">
             <div class="flex max-w-4xl mx-auto">
                <input type="text" id="searchInput" placeholder="தேடவும்: வெப் டெவலப்பர், லோகோ டிசைன், உள்ளடக்கம் எழுதுதல்..." class="w-full p-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <button onclick="performSearch()" class="bg-indigo-600 text-white p-3 rounded-r-lg hover:bg-indigo-700 transition duration-150">
                    <span data-lucide="search" class="w-6 h-6"></span>
                </button>
            </div>
        </section>


        <section>
            <h3 id="listTitle" class="text-2xl font-bold text-gray-800 mb-6">அனைத்து வேலைப் பட்டியல்களும்</h3>
            <div id="contentList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <p id="loadingIndicator" class="col-span-full text-center text-indigo-500 font-semibold">
                    தரவுகளைப் பெறுகிறது... தயவுசெய்து காத்திருக்கவும்.
                </p>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-white mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center">
            <p>&copy; 2024 Vorliyo. சகான் உருவாக்கிய ஃப்ரீலான்ஸ் தளம். | <a href="owner-admin.html" class="underline">Owner Login</a></p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, query, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firebase Config (Please make sure this is your config!)
        const FIREBASE_CONFIG = {
            apiKey: "AIzaSyDD755-oGyx0hwrLykhF7m2k1uWFnLFMDQ",
            authDomain: "vorliyo.firebaseapp.com",
            projectId: "vorliyo",
            storageBucket: "vorliyo.firebasestorage.app",
            messagingSenderId: "480604417883",
            appId: "1:480604417883:web:5b4926a2a1b21f3ae2747e",
        };
        
        const firebaseConfig = FIREBASE_CONFIG;
        // The __app_id variable is essential for Firestore pathing in this environment.
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'vorliyo-default-app-id';

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        let allJobs = []; 
        let allServices = []; 
        let currentView = 'jobs'; // Default view

        // --- AUTH STATE MANAGEMENT ---
        const authButton = document.getElementById('authButton');
        const dashboardLink = document.getElementById('dashboardLink');
        const postJobBtn = document.getElementById('postJobBtn');
        
        onAuthStateChanged(auth, (user) => {
            if (user) {
                authButton.textContent = 'வெளியேறு';
                authButton.onclick = handleSignOut;
                authButton.classList.remove('bg-indigo-600');
                authButton.classList.add('bg-red-500', 'hover:bg-red-600');
                dashboardLink.classList.remove('hidden');
                postJobBtn.classList.remove('hidden');
            } else {
                authButton.textContent = 'உள்நுழைய / பதிவு செய்ய';
                authButton.onclick = () => { window.location.href = 'user-login.html'; };
                authButton.classList.remove('bg-red-500');
                authButton.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
                dashboardLink.classList.add('hidden');
                postJobBtn.classList.add('hidden');
            }
        });

        function handleSignOut() {
            signOut(auth).then(() => {
                window.location.reload(); 
            }).catch((error) => {
                console.error("Sign Out Error:", error);
            });
        }

        // --- VIEW SWITCHING ---
        window.changeView = (view) => {
            currentView = view;
            const jobBtn = document.getElementById('jobViewBtn');
            const serviceBtn = document.getElementById('serviceViewBtn');
            const title = document.getElementById('listTitle');

            if (view === 'jobs') {
                jobBtn.classList.add('bg-indigo-600', 'text-white');
                jobBtn.classList.remove('bg-white', 'text-indigo-600');
                serviceBtn.classList.add('bg-white', 'text-indigo-600');
                serviceBtn.classList.remove('bg-indigo-600', 'text-white');
                title.textContent = 'அனைத்து வேலைப் பட்டியல்களும்';
                renderContent(allJobs);
            } else { // services
                serviceBtn.classList.add('bg-indigo-600', 'text-white');
                serviceBtn.classList.remove('bg-white', 'text-indigo-600');
                jobBtn.classList.add('bg-white', 'text-indigo-600');
                jobBtn.classList.remove('bg-indigo-600', 'text-white');
                title.textContent = 'அனைத்து ஃப்ரீலான்ஸ் சேவைகளும்';
                renderContent(allServices);
            }
        }
        
        // --- FIREBASE DATA FETCHING ---
        function getPublicData() {
            // Path: artifacts / {appId} / public / data / jobs
            const jobQuery = query(collection(db, 'artifacts', appId, 'public', 'data', 'jobs'));
            // Path: artifacts / {appId} / public / data / services
            const serviceQuery = query(collection(db, 'artifacts', appId, 'public', 'data', 'services'));
            
            // Fetch Jobs
            onSnapshot(jobQuery, (snapshot) => {
                allJobs = [];
                snapshot.forEach((doc) => {
                    allJobs.push({ id: doc.id, ...doc.data() });
                });
                if (currentView === 'jobs') renderContent(allJobs);
                console.log("Jobs loaded:", allJobs.length);
            }, (error) => { console.error("Error fetching jobs:", error); });

            // Fetch Services
            onSnapshot(serviceQuery, (snapshot) => {
                allServices = [];
                snapshot.forEach((doc) => {
                    allServices.push({ id: doc.id, ...doc.data() });
                });
                if (currentView === 'services') renderContent(allServices);
                console.log("Services loaded:", allServices.length);
            }, (error) => { console.error("Error fetching services:", error); });

            document.getElementById('loadingIndicator').style.display = 'none';
        }

        // --- RENDERING FUNCTIONS ---
        function renderContent(items) {
            const contentList = document.getElementById('contentList');
            contentList.innerHTML = ''; // Clear previous content

            if (items.length === 0) {
                contentList.innerHTML = '<p class="col-span-full text-center text-gray-500">இந்த பிரிவில் தரவுகள் எதுவும் இல்லை.</p>';
                return;
            }

            items.forEach(item => {
                const isJob = currentView === 'jobs';
                const title = item.title || 'தலைப்பு இல்லை';
                const description = (item.description || 'விளக்கம் இல்லை').substring(0, 120) + '...';
                const detailLink = isJob ? `user-job-details.html?id=${item.id}` : `user-service-details.html?id=${item.id}`;
                
                const cardHtml = `
                    <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 ${isJob ? 'border-green-500' : 'border-indigo-500'} flex flex-col justify-between h-full">
                        <div>
                            <h4 class="text-xl font-bold text-gray-900 mb-2">${title}</h4>
                            <p class="text-gray-600 text-sm mb-4">${description}</p>
                        </div>
                        <div>
                            <div class="flex justify-between items-center mt-3 border-t pt-3">
                                <span class="text-lg font-extrabold ${isJob ? 'text-green-600' : 'text-indigo-600'}">
                                    ${isJob ? `LKR ${item.budget || '—'}` : `LKR ${item.price || '—'} / மணி`}
                                </span>
                                <span class="text-xs font-medium text-gray-500">
                                    ${isJob ? `Posted by: ${item.clientName || 'Client'}` : `Freelancer: ${item.freelancerName || 'User'}`}
                                </span>
                            </div>
                            <a href="${detailLink}" class="mt-3 w-full block text-center bg-indigo-600 text-white p-2 rounded-lg hover:bg-indigo-700 transition duration-150">
                                விவரங்களைப் பார்க்க / விண்ணப்பிக்க
                            </a>
                        </div>
                    </div>
                `;
                contentList.innerHTML += cardHtml;
            });
            lucide.createIcons();
        }

        window.performSearch = () => {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            let data = currentView === 'jobs' ? allJobs : allServices;

            const filtered = data.filter(item => 
                (item.title && item.title.toLowerCase().includes(searchTerm)) ||
                (item.description && item.description.toLowerCase().includes(searchTerm)) ||
                (item.category && item.category.toLowerCase().includes(searchTerm))
            );
            
            renderContent(filtered);
        }

        // --- INITIAL SETUP ---
        document.addEventListener('DOMContentLoaded', () => {
            getPublicData();
        });
        
    </script>
</body>
</html>
```eof

### ➡️ அடுத்த படி (Next Step)

சஹான், இப்போது நீங்கள் செய்ய வேண்டியது:

1.  உங்கள் **`vorliyo-platform`** களஞ்சியத்தின் **Root-இல்** (கோப்புறைகள் இல்லாமல்) **`user-index.html`** என்ற கோப்பை உருவாக்கி, மேலே உள்ள முழுமையான குறியீட்டையும் **பதிவேற்றவும்**.
2.  பதிவேற்றம் முடிந்ததும், **"சரி (OK)"** என்று எனக்குத் தெரிவிக்கவும்.

அதற்குப் பிறகு, நாம் **உள்நுழைவு மற்றும் பதிவு செய்யும் பக்கத்திற்கான** (`user-login.html`) குறியீட்டைப் பார்க்கலாம்.
